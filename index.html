<!DOCTYPE html>
<html>
<head>
  <title>Solana Token Transfer DApp</title>
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
  <script src="script.js"></script>
</head>
<body>
  <h1>Solana Token Transfer</h1>
  <div>
    <label for="tokenAddress">Token Address:</label>
    <input type="text" id="tokenAddress" placeholder="Enter token address">
  </div>
  <div>
    <label for="receiverAddress">Receiver Address:</label>
    <input type="text" id="receiverAddress" placeholder="Enter receiver address">
  </div>
  <div>
    <label for="amount">Amount:</label>
    <input type="number" id="amount" placeholder="Enter amount">
  </div>
  <button id="connectWallet">Connect Wallet</button>
  <button id="transferTokens" disabled>Transfer Tokens</button>
  <div id="status"></div>
  <script>
    const connectButton = document.getElementById("connectWallet");
const transferButton = document.getElementById("transferTokens");
const statusElement = document.getElementById("status");

connectButton.addEventListener("click", async () => {
  try {
    const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com");
    const provider = window.solana; // Access wallet provider globally
    const wallet = await provider.connect();
    const publicKey = wallet.publicKey.toBase58();
    statusElement.textContent = `Connected to wallet: ${publicKey}`;
    transferButton.disabled = false;
  } catch (error) {
    console.error("Error connecting to wallet:", error);
    statusElement.textContent = "Wallet connection failed";
  }
});

transferButton.addEventListener("click", async () => {
  try {
    const tokenAddress = document.getElementById("tokenAddress").value;
    const receiverAddress = document.getElementById("receiverAddress").value;
    const amount = document.getElementById("amount").value;

    const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com");
    const provider = window.solana;
    const wallet = provider.connected;

    const token = new solanaWeb3.PublicKey(tokenAddress);
    const receiver = new solanaWeb3.PublicKey(receiverAddress);

    const transaction = new solanaWeb3.Transaction({
      feePayer: wallet.publicKey,
      instructions: [
        await Token.createTransferCheckedInstruction(
          token,
          wallet.publicKey,
          receiver,
          wallet.publicKey,
          new solanaWeb3.BN(amount)
        )
      ]
    });

    const signature = await wallet.signTransaction(transaction);
    const result = await connection.sendRawTransaction(signature);

    statusElement.textContent = `Transaction submitted: ${result}`;
  } catch (error) {
    console.error("Error transferring tokens:", error);
    statusElement.textContent = "Transaction failed";
  }
});
    
  </script>
</body>
</html>
