<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solana Token Transfer</title>
  <script src="https://cdn.jsdelivr.net/npm/@solana/wallet-standard-wallet-adapter@1.1.2/lib/cjs/index.min.js"></script>
<style>
  /* Add basic styling as needed */
.wallet-buttons {
  display: flex;
  justify-content: space-around;
  margin-bottom: 20px;
}

#error-message {
  color: red;
  font-weight: bold;
  margin-top: 10px;
}

</style>

</head>
<body>
  <h1>Solana Token Transfer</h1>
  <div class="wallet-buttons">
    <button id="connect-phantom">Connect Phantom</button>
    <button id="connect-solflare">Connect SolFlare</button>
  </div>
  <br>
  <form id="token-transfer-form">
    <label for="contract-address">Token Contract Address:</label>
    <input type="text" id="contract-address" placeholder="Enter contract address" required>
    <br>
    <label for="receiver-address">Receiver Address:</label>
    <input type="text" id="receiver-address" placeholder="Enter receiver address" required>
    <br>
    <label for="amount">Amount:</label>
    <input type="number" id="amount" placeholder="Enter amount" required>
    <br>
    <label for="decimals">Token Decimals:</label>
    <input type="number" id="decimals" placeholder="Enter token decimals" required>
    <br>
    <button type="submit" id="send-tokens">Send Tokens</button>
  </form>
  <div id="error-message"></div>
  <script>
    const phantomProvider = new solanaWeb3.PhantomProvider();
const solflareProvider = new solanaWeb3.SolFlareProvider();

const walletAdapter = new solanaWeb3.WalletAdapterWeb({
  providers: [phantomProvider, solflareProvider],
});

const connectPhantom = async () => {
  try {
    await walletAdapter.connect();
    console.log('Connected to Phantom');
  } catch (error) {
    console.error('Error connecting to Phantom:', error);
  }
};

const connectSolFlare = async () => {
  try {
    await walletAdapter.connect();
    console.log('Connected to SolFlare');
  } catch (error) {
    console.error('Error connecting to SolFlare:', error);
  }
};

const sendTokens = async () => {
  const contractAddress = document.getElementById('contract-address').value;
  const receiverAddress = document.getElementById('receiver-address').value;
  const amount = parseInt(document.getElementById('amount').value);
  const decimals = parseInt(document.getElementById('decimals').value);

  if (!contractAddress || !receiverAddress || !amount || !decimals) {
    return alert('Please fill in all fields');
  }

  const connection = new solanaWeb3.Connection('https://api.devnet.solana.com');
  const wallet = walletAdapter.wallet;

  try {
    // Calculate the actual token amount considering decimals
    const adjustedAmount = amount * Math.pow(10, -decimals);

    const token = await splToken.Token.createProgramAccount(
      connection,
      wallet,
      new solanaWeb3.Keypair(),
      new solanaWeb3.PublicKey(contractAddress),
      wallet.publicKey,
      // Adjusted amount based on decimals
      adjustedAmount
    );

    const transaction = await token.transfer(
      connection,
      wallet,
      token.publicKey,
      new solanaWeb3.PublicKey(receiverAddress),
      wallet.publicKey,
      // Adjusted amount based on decimals
      adjustedAmount,
      // Adjusted amount based on decimals
      adjustedAmount
    );

    await connection.sendTransaction(transaction);
    alert('Tokens transferred successfully!');
  } catch (error) {
    console.error('Error sending tokens:', error);
    alert('An error occurred while sending tokens');
  }
};

document.getElementById('connect-phantom').addEventListener('click', connectPhantom);
document.getElementById('connect-solflare').addEventListener('click', connectSolFlare);
document.getElementById('send-tokens').addEventListener('click', sendTokens);
  </script>
</body>
</html>
